<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centered Form with Loading Indicator</title>
    <style>
        @font-face {
            font-family: 'WorkSans-Italic';
            src: url('../fonts/static/WorkSans-Italic.ttf') format('truetype');
            /* Add other font formats if needed */
        }
        @font-face {
            font-family: 'WorkSans-SemiBold';
            src: url('../fonts/static/WorkSans-SemiBoldItalic.ttf') format('truetype');
            /* Add other font formats if needed */
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .title_container {
            text-align: center;
        }

        .container, #header {
            width: 100%;
            padding: 10px;
            text-align: center;
            transition: opacity 1s; /* CSS transition for opacity */
        }

        form {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        label {
            margin-bottom: 8px;
        }

        input {
            margin-bottom: 16px;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 15px;
            width: 45em;
            box-sizing: border-box;
            text-align: center;
        }

        button {
            margin-bottom: 16px;
            padding: 20px;
            border-radius: 20px;
            width: 30%;
            box-sizing: border-box;
            text-align: center;
            cursor: pointer;
            background-color: #0e0e0e;
            color: #fff;
            border: none;
        }

        .loading-indicator {
            display: none;
            font-size: 20px;
        }

        .content {
            display: none;
            text-align: justify;
        }

        #content {
            position: absolute;
            top: 100px;
            left: 150px;
        }

        #arrowButton {
            display: none;
            position: absolute;
            top: 500px;
            left: 150px;
            font-size: 20px;
            cursor: pointer;
            background: none;
            border: none;
            color: #0e0e0e;
        }
        /* This style ensures smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Class for fade-out effect */
        .fade-out {
            opacity: 0;
            transition: opacity 1s; /* CSS transition for opacity */
        }

    </style>
</head>
<body>

<div class="title_container">
    <h1 id="header" class="container">Describe preferences...</h1>
    <div class="container" id="formContainer">
        <form method="post" action="#" onsubmit="submitForm(); return false;">
            <input type="text" name="industry" id="industry" placeholder="Industry Info">
            <input type="text" name="location" id="location" placeholder="Preferred Location">
            <input type="text" name="revenue" id="revenue" placeholder="Revenue">
            <input type="text" name="employees" id="employees" placeholder="Employee Number">
            <button type="submit">Submit</button>
        </form>
        <div class="loading-indicator" id="loadingIndicator">Loading...</div>
    </div>
</div>

<div class="content fade-out" id="content">
    <p id="state" style="font-size: 50px; font-family: 'WorkSans-SemiBold',sans-serif"></p>
    <p id="score" style="font-size: 30px; padding-left: 2em"></p>
    <p id="avg_salary" style="font-size: 30px; padding-left: 2em"></p>
    <p id="avg_age" style="font-size: 30px; padding-left: 2em"></p>
</div>
<img id="image" width="700" style="display: none" src="../map.png" alt="US map">

<button id="arrowButton" onclick="changeContent()">âž”</button>

<script>
    // Global variable to store JSON data and keys
    var jsonData;
    var keys = [];
    var currentIndex = 0;

    function submitForm() {
        // Get input values
        var industry = document.getElementById('industry').value;
        var location = document.getElementById('location').value;
        var revenue = document.getElementById('revenue').value;
        var employees = document.getElementById('employees').value;

        // Log values to console
        console.log('Industry:', industry, 'Location:', location, 'Revenue:', revenue, 'Employees:', employees);

        // Trigger the loading indicator
        showLoadingIndicator();

        // Simulate asynchronous action (e.g., sending data to the server)
        setTimeout(function () {
            // Hide the loading indicator
            hideLoadingIndicator();

            // Remove the form from the DOM
            removeForm();

            // Fetch external data
            fetchData()
            .then(data => {
                // Ensure that 'data.message' is structured correctly in your JSON file
                if (data) {
                    // Store JSON data and keys
                    jsonData = data;
                    keys = Object.keys(data);

                    // Update content with fetched data
                    var content = document.getElementById('content');
                    content.style.display = 'block';

                    var arrowButton = document.getElementById('arrowButton');
                    arrowButton.style.display = 'block';

                    var image = document.getElementById('image');
                    image.style.display = 'block';

                    // Use the first key from the keys array
                    var currentKey = keys[0];

                    var p = document.getElementById('state');
                    arrowButton.style.display = 'block';
                    p.textContent = "State: " + currentKey;

                    var p = document.getElementById('score');
                    arrowButton.style.display = 'block';
                    p.textContent = "Score: " + jsonData[currentKey].score;

                    var p = document.getElementById('avg_salary');
                    arrowButton.style.display = 'block';
                    p.textContent = "Average salary: " + jsonData[currentKey].avg_salary;

                    var p = document.getElementById('avg_age');
                    arrowButton.style.display = 'block';
                    p.textContent = "Average age: " + jsonData[currentKey].avg_age;

                    // Remove fade-out class to trigger fade-in effect
                    content.classList.remove('fade-out');

                    // Optionally, you can remove the content div from the DOM after the fade-out effect
                    setTimeout(function () {
                        // content.remove();
                    }, 1000); // Wait for 1 second (same duration as the transition)
                } else {
                    console.error('Invalid data structure:', data);
                }
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
    }, 2000); // Simulated delay of 2 seconds (adjust as needed)
}


    function showLoadingIndicator() {
        var loadingIndicator = document.getElementById('loadingIndicator');
        loadingIndicator.style.display = 'block';

        var formContainer = document.getElementById('formContainer');
        formContainer.classList.add('fade-out');

        var header = document.getElementById('header');
        header.classList.add('fade-out');
    }

    function hideLoadingIndicator() {
        var loadingIndicator = document.getElementById('loadingIndicator');
        loadingIndicator.style.display = 'none';

        var formContainer = document.getElementById('formContainer');
        formContainer.classList.remove('fade-out');
    }

    function removeForm() {
        var formContainer = document.getElementById('formContainer');
        formContainer.remove();
    }

    // Function to simulate fetching external data from a local JSON file using XMLHttpRequest
    function fetchData() {
    return new Promise((resolve, reject) => {
        // Create a new XMLHttpRequest object
        var xhr = new XMLHttpRequest();

        // Configure it with the request method and URL of the local JSON file
        xhr.open('GET', 'data.json', true);

        // Set up the onload and onerror event handlers
        xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 300) {
                // Request was successful
                try {
                    // Log the entire JSON response to the console
                    console.log('JSON Response:', xhr.responseText);

                    // Parse the JSON response
                    var jsonResponse = JSON.parse(xhr.responseText);
                    resolve(jsonResponse);
                } catch (error) {
                    reject('Error parsing JSON');
                }
            } else {
                // Request failed
                reject(xhr.statusText);
            }
        };

        xhr.onerror = function () {
            // Network error
            reject('Network error');
        };

        // Send the request
        xhr.send();
    });
    }

    function changeContent() {
    // Implement the logic to change content here
    console.log('Arrow button clicked');

    // Get references to the elements
    var state = document.getElementById('state');
    var score = document.getElementById('score');
    var avg_salary = document.getElementById('avg_salary');
    var avg_age = document.getElementById('avg_age');

    // Add fade-out class to trigger fade-out effect
    state.classList.add('fade-out');
    score.classList.add('fade-out');
    avg_salary.classList.add('fade-out');
    avg_age.classList.add('fade-out');

    setTimeout(function () {
        // Increment the currentIndex or reset to 0 if at the end
        currentIndex = (currentIndex + 1) % keys.length;

        // Get the current key
        var currentKey = keys[currentIndex];

        // Change content using the current key
        state.textContent = "State: " + currentKey;
        score.textContent = "Score: " + jsonData[currentKey].score;
        avg_salary.textContent = "Average salary: " + jsonData[currentKey].avg_salary;
        avg_age.textContent = "Average age: " + jsonData[currentKey].avg_age;

        // Remove fade-out class to trigger fade-in effect
        state.classList.remove('fade-out');
        score.classList.remove('fade-out');
        avg_salary.classList.remove('fade-out');
        avg_age.classList.remove('fade-out');
    }, 1000); // Adjust the delay as needed
}
</script>

</body>
</html>
